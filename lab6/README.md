# ОТЧЕТ ПО ЛАБОРАТОРНОЙ РАБОТЕ №6

**Тема:** Твердотельное моделирование и аффинные преобразования в 3D пространстве

---

## 1. ЦЕЛЬ РАБОТЫ

Целью лабораторной работы является:
- Изучение основ твердотельного моделирования трехмерных объектов
- Освоение методов аффинных преобразований в 3D пространстве (масштабирование, поворот, перенос)
- Построение 3D модели буквы "К" с помощью библиотеки matplotlib
- Визуализация твердотельной модели и её ортогональных проекций на координатные плоскости

---

## 2. ТЕОРЕТИЧЕСКИЕ СВЕДЕНИЯ

### 2.1. Твердотельное моделирование

Твердотельное моделирование — это метод представления трехмерных объектов в компьютерной графике, при котором объект описывается через множество граней (полигонов), образующих замкнутую поверхность.

Основные компоненты твердотельной модели:
- **Вершины (vertices)** — точки в 3D пространстве с координатами (x, y, z)
- **Ребра (edges)** — отрезки, соединяющие вершины
- **Грани (faces)** — замкнутые полигоны, образованные ребрами

### 2.2. Однородные координаты

Для представления аффинных преобразований используются **однородные координаты**. Точка (x, y, z) представляется вектором (x, y, z, 1), что позволяет записать все аффинные преобразования в виде матриц 4×4.

### 2.3. Аффинные преобразования

#### Матрица переноса (Translation):
```
T(dx, dy, dz) = | 1  0  0  dx |
                | 0  1  0  dy |
                | 0  0  1  dz |
                | 0  0  0  1  |
```

#### Матрица масштабирования (Scaling):
```
S(sx, sy, sz) = | sx  0   0   0 |
                | 0   sy  0   0 |
                | 0   0   sz  0 |
                | 0   0   0   1 |
```

#### Матрица поворота вокруг произвольной оси (Rotation):
Для поворота на угол θ вокруг оси, заданной единичным вектором **u** = (ux, uy, uz), используется формула Родрига:

```
R(u, θ) = | t·ux² + c      t·ux·uy - s·uz  t·ux·uz + s·uy  0 |
          | t·ux·uy + s·uz  t·uy² + c      t·uy·uz - s·ux  0 |
          | t·ux·uz - s·uy  t·uy·uz + s·ux  t·uz² + c      0 |
          | 0               0               0              1 |
```
где: c = cos(θ), s = sin(θ), t = 1 - cos(θ)

### 2.4. Ортогональные проекции

В работе строятся три основные проекции:
- **Проекция на плоскость Oxy** (вид сверху) — отбрасывание координаты Z
- **Проекция на плоскость Oxz** (вид спереди) — отбрасывание координаты Y
- **Проекция на плоскость Oyz** (вид сбоку) — отбрасывание координаты X

---

## 3. ОПИСАНИЕ ПРОГРАММЫ

### 3.1. Структура класса SolidK

Программа реализована в виде класса `SolidK`, который:
1. Создает твердотельную модель буквы "К"
2. Хранит вершины, грани и ребра объекта
3. Предоставляет методы для аффинных преобразований

### 3.2. Построение геометрии буквы "К"

Буква "К" строится следующим образом:

1. **Определение контура** — задаются 12 опорных точек плоского контура в плоскости XY:
   - Вертикальная палка (точки 0-3, 10-11)
   - Верхняя ножка (точки 4-6)
   - Нижняя ножка (точки 7-9)

2. **Создание объема** — контур дублируется на двух уровнях по оси Z:
   - Задняя грань: z = 0.0
   - Передняя грань: z = 1.0
   - Итого: 24 вершины (12 на каждой грани)

3. **Формирование граней**:
   - Задняя грань (полигон из точек 0-11)
   - Передняя грань (полигон из точек 12-23)
   - Боковые грани (12 прямоугольников, соединяющих переднюю и заднюю грани)
   - Внутренняя грань (перемычка между точками 3 и 9)

### 3.3. Применяемые преобразования

Для постановки буквы вертикально применяется последовательность преобразований:

```python
# 1. Масштабирование (увеличение на 20%)
M_scale = S(1.2, 1.2, 1.2)

# 2. Поворот вокруг оси X на 90° (постановка вертикально)
M_rot_standing = R([1,0,0], 90°)

# 3. Перенос для центрирования
M_trans_center = T(-2, 0.5, 0)

# Итоговая матрица
M_total = M_trans_center × M_rot_standing × M_scale
```

**Важно:** Преобразования применяются **справа налево** (сначала масштабирование, затем поворот, затем перенос).

### 3.4. Визуализация

Программа создает четыре подграфика:
1. **3D твердотельная модель** — закрашенная объемная модель с использованием `Poly3DCollection`
2. **Проекция Oxy** (вид сверху) — каркасное изображение
3. **Проекция Oxz** (вид спереди) — каркасное изображение
4. **Проекция Oyz** (вид сбоку) — каркасное изображение

---

## 4. РЕЗУЛЬТАТЫ РАБОТЫ

### 4.1. Полученная матрица преобразования

При запуске программы выводится итоговая матрица преобразования:

```
--- Лабораторная 6b: Матрица преобразования ---
Итоговая матрица (Scale -> Rotate X 90deg -> Translate):
[[ 1.2   0.    0.   -2.  ]
 [ 0.    0.   -1.2   0.5 ]
 [ 0.    1.2   0.    0.  ]
 [ 0.    0.    0.    1.  ]]
```

**Анализ матрицы:**
- Первая строка: масштабирование по X (1.2) и перенос (-2)
- Вторая строка: поворот (обмен осей Y↔Z) с масштабированием и переносом
- Третья строка: поворот (обмен осей Y↔Z) с масштабированием
- Четвертая строка: однородные координаты (всегда [0, 0, 0, 1])

### 4.2. Графическая визуализация

Программа создает окно с четырьмя графиками:

1. **3D модель** (верхний левый):
   - Закрашенная объемная буква "К" небесно-голубого цвета (skyblue)
   - Темно-синий каркас граней (navy)
   - Буква стоит вертикально
   - Прозрачность 80% для визуализации граней

2. **Проекция Oxy** (верхний правый):
   - Вид сверху на букву
   - Видна форма основания буквы
   - Характерная форма буквы "К" в плоскости

3. **Проекция Oxz** (нижний левый):
   - Вид спереди
   - Показывает высоту и ширину буквы
   - Четко видна структура буквы "К"

4. **Проекция Oyz** (нижний правый):
   - Вид сбоку
   - Показывает толщину объемной буквы (1.2 единицы после масштабирования)

### 4.3. Ключевые характеристики модели

- **Количество вершин:** 24 (12 точек × 2 грани)
- **Количество граней:** 15 (передняя + задняя + 12 боковых + 1 внутренняя)
- **Размеры после преобразований:**
  - Ширина (X): ~4.8 единиц
  - Высота (Z): ~6.0 единиц (после поворота)
  - Толщина (Y): ~1.2 единицы

---

## 5. АНАЛИЗ КОДА

### 5.1. Ключевые фрагменты

**Инициализация вершин:**
```python
# Заполняем массив вершин
for i in range(num_points):
    # Задняя грань (индексы 0-11)
    self.vertices[i] = [k_xy[i][0], k_xy[i][1], z_back, 1]
    # Передняя грань (индексы 12-23)
    self.vertices[i + num_points] = [k_xy[i][0], k_xy[i][1], z_front, 1]
```

**Создание закрашенных полигонов:**
```python
collection = Poly3DCollection(
    poly3d_list, facecolor="skyblue", edgecolor="navy", alpha=0.8
)
ax.add_collection3d(collection)
```

### 5.2. Преимущества реализации

- Использование однородных координат позволяет легко комбинировать преобразования
- Класс `SolidK` инкапсулирует геометрию и методы преобразований
- Грани определены явно, что обеспечивает корректное закрашивание
- Проекции строятся автоматически на основе 3D координат

---

## 6. ВЫВОДЫ

В ходе выполнения лабораторной работы были достигнуты следующие результаты:

1. **Освоены основы твердотельного моделирования:**
   - Изучен метод представления 3D объектов через вершины, ребра и грани
   - Реализована твердотельная модель буквы "К" с использованием 24 вершин и 15 граней
   - Применена технология закрашивания граней с помощью `Poly3DCollection`

2. **Изучены аффинные преобразования в 3D:**
   - Реализованы матрицы переноса, масштабирования и поворота
   - Применена композиция преобразований для постановки буквы вертикально
   - Освоен метод использования однородных координат для упрощения операций

3. **Получены практические навыки визуализации:**
   - Построена 3D модель с корректным освещением и закрашиванием
   - Созданы три ортогональных проекции объекта на координатные плоскости
   - Освоены возможности библиотеки matplotlib для 3D графики

4. **Практическая значимость:**
   - Методы твердотельного моделирования широко применяются в CAD/CAM системах
   - Аффинные преобразования являются основой компьютерной графики и анимации
   - Полученные навыки применимы в разработке игр, систем визуализации и инженерных приложений

5. **Особенности реализации:**
   - Поворот на 90° вокруг оси X превращает горизонтальную букву в вертикальную
   - Масштабирование на 1.2 увеличивает модель на 20% по всем направлениям
   - Перенос на вектор (-2, 0.5, 0) центрирует объект в пространстве

6. **Теоретическое понимание:**
   - Закреплено понимание систем координат в 3D пространстве
   - Освоены математические основы преобразований координат
   - Понятна связь между 3D моделью и её 2D проекциями

**Общий вывод:** Лабораторная работа успешно выполнена. Все поставленные задачи решены: создана твердотельная модель буквы "К", применены аффинные преобразования для ориентации модели в пространстве, построены 3D визуализация и ортогональные проекции. Программа работает корректно, результаты соответствуют ожиданиям. Полученные знания и навыки являются фундаментальными для дальнейшего изучения компьютерной графики и 3D моделирования.
